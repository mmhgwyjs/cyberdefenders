# <a href="https://cyberdefenders.org/blueteam-ctf-challenges/maldoc101/">MalDoc101</a>

**Platform:** CyberDefenders

**Scenario:** It is common for threat actors to utilize living off the land (LOTL) techniques, such as the execution of PowerShell to further their attacks and transition from macro code. This challenge is intended to show how you can often times perform quick analysis to extract important IOCs. The focus of this exercise is on static techniques for analysis.

As a security blue team analyst, analyze the artifacts and answer the questions.

**Category:** Malware Analysis

**Difficulty:** Medium

**File:** `sample.bin`

**Tools:** `Oledump`

**Note:** In this walkthrough, I will use the SIFT Workstation from SANS to analyze the provided file. If you have not set it up yet, I highly recommend following this [forensics lab](https://github.com/mmhgwyjs/forensics-lab/blob/main/README.md) guide for assistance with your installation.

---

## **Preparations**

![image](https://github.com/user-attachments/assets/28e317c3-b59a-4edd-9378-e1ac3753b56a)

https://github.com/decalage2/oletools/wiki/Install

https://github.com/decalage2/oletools/releases

https://pip.pypa.io/en/stable/installation/

## **Questions and Answers**

***1. What is the number of the highest stream that contains macros in this document?***

16

![image](https://github.com/user-attachments/assets/16229f62-dd77-440f-bc12-cd97a27ad333)

oledump sample.bin

***2. What event is used to begin the execution of the macros?***

Document_open

olevba sample.bin

![image](https://github.com/user-attachments/assets/d44fbc29-f5f0-408d-ad85-f3bb7b4bfadf)


***3. What malware family was this maldoc attempting to drop?***

emotet

![image](https://github.com/user-attachments/assets/5d3dc13a-9ce1-47ef-8714-a31c04bfb3c5)

certutil -hashfile sample.bin SHA256

d50d98dcc8b7043cb5c38c3de36a2ad62b293704e3cf23b0cd7450174df53fee

![image](https://github.com/user-attachments/assets/74ad1d00-5a11-4366-848b-7e1a9feb11a0)

***4. What stream is responsible for the storage of the base64-encoded string?***

34

![image](https://github.com/user-attachments/assets/9f09d620-14f2-4ccf-87b6-ba21462dcc42)

![image](https://github.com/user-attachments/assets/44fac64d-d40f-4b79-88eb-f146544f3307)

***5. This document contains a user-form. Provide the name?***

***6. This document contains an obfuscated base64 encoded string; what value is used to pad (or obfuscate) this string?***

***7. What is the program executed by the base64 encoded string?***

***8. What WMI class is used to create the process to launch the trojan?***

***9. Provide the first FQDN for the multiple domains contacted to download a trojan, as per the provided hint.***

haoqunkong.com

![image](https://github.com/user-attachments/assets/a47385ca-1184-4c53-a4f9-63bc216f8ae9)

VT
