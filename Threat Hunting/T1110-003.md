# <a href="https://cyberdefenders.org/blueteam-ctf-challenges/t1110003/">T1110-003</a>

**Platform:** CyberDefenders

**Scenario:** Adversaries may use a single or small list of commonly used passwords against many different accounts to attempt to acquire valid account credentials. Password spraying uses one password (e.g. 'Password01'), or a small list of commonly used passwords, that may match the complexity policy of the domain. Logins are attempted with that password against many different accounts on a network to avoid account lockouts that would normally occur when brute forcing a single account with many passwords.[1]

Typically, management services over commonly used ports are used when password spraying. Commonly targeted services include the following:

SSH (22/TCP)
Telnet (23/TCP)
FTP (21/TCP)
NetBIOS / SMB / Samba (139/TCP & 445/TCP)
LDAP (389/TCP)
Kerberos (88/TCP)
RDP / Terminal Services (3389/TCP)
HTTP/HTTP Management Services (80/TCP & 443/TCP)
MSSQL (1433/TCP)
Oracle (1521/TCP)
MySQL (3306/TCP)
VNC (5900/TCP)
In addition to management services, adversaries may "target single sign-on (SSO) and cloud-based applications utilizing federated authentication protocols," as well as externally facing email applications, such as Office 365.[2]

In default environments, LDAP and Kerberos connection attempts are less likely to trigger events over SMB, which creates Windows "logon failure" event ID 4625.

**Category:** Threat Hunting

**Difficulty:** Easy

**Files:** `N/A`

**Tools:** `` 

**Note:** In this walkthrough, CyberDefenders offers a lab environment for us to utilize. This feature is included with the PRO subscription.

## **Preparations** 

## **Questions and Answers**

***1. Who was the last logged-in user?***  

***2. What is the logon type of the failed logons?***  

***3. What is the protocol the attacker tried to bruteforce?***  

***4. How many users did the attacker succeed in getting their accounts?***  

***5. According to Microsoft, what is the description of the "Sub Status" code for event ID 4625?***  

***6. How long did the bruteforce last? MM***  

***7. After how long did the attacker login to the machine again? MM***  

***8. What is the name of the policy used to lock the account after a certain number of failed login attempts?***


## References

[1] https://www.blackhillsinfosec.com/password-spraying-other-fun-with-rpcclient/
[2] https://www.us-cert.gov/ncas/alerts/TA18-086A
